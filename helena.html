<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
  <title>Document</title>
</head>

<style>
  body {
    background: linear-gradient(-45deg, #0ef056, #12e090, #16d0ca);
    height: 100vh;
    background-size: 400% 400%;
    -webkit-animation: AnimationName 13s ease infinite;
    -moz-animation: AnimationName 13s ease infinite;
    animation: gradient 13s ease infinite;
    padding: 0;
    margin: 0;
    outline: none;
    user-select: none;
    overflow-x: hidden;
  }

  * {
    font-family: "Poppins", sans-serif;
  }

  @-webkit-keyframes gradient {
    0% {
      background-position: 0% 96%;
    }

    50% {
      background-position: 100% 5%;
    }

    100% {
      background-position: 0% 96%;
    }
  }

  @-moz-keyframes gradient {
    0% {
      background-position: 0% 96%;
    }

    50% {
      background-position: 100% 5%;
    }

    100% {
      background-position: 0% 96%;
    }
  }

  @keyframes gradient {
    0% {
      background-position: 0% 50%;
    }

    50% {
      background-position: 100% 50%;
    }

    100% {
      background-position: 0% 50%;
    }
  }

  .container {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
  }

  .container h1 {
    color: white;
  }

  .container input[type="button"] {
    background: #16d0ca;
    border: none;
    border: 1px solid rgba(255, 255, 255, 0.44);
    border-radius: 15px;
    color: white;
    font-weight: bold;
    z-index: 1;
    transition: 400ms;
    margin-top: 20px;
    padding: 20px;
    outline: none;
  }

  .container input[type="button"]:hover {
    cursor: pointer;
    opacity: 0.7;
  }

  .container input[type="button"]:active,
  .container>img:active {
    transform: translateY(10px);
  }

  .container input[type="button"]::selection {
    background: transparent;
  }

  .animal {
    width: 20em;
    height: 20em;
    border-radius: 15px;
    transition: all 0.5s ease;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  }

  .rarity-common {
    border: 4px solid #a0a0a0;
  }

  .rarity-uncommon {
    border: 4px solid #4CAF50;
  }

  .rarity-rare {
    border: 4px solid #2196F3;
  }

  .rarity-epic {
    border: 4px solid #9C27B0;
    animation: glow 2s infinite alternate;
  }

  .rarity-legendary {
    border: 4px solid #FFD700;
    animation: glow 1.5s infinite alternate;
  }

  @keyframes glow {
    from {
      box-shadow: 0 0 10px -5px;
    }

    to {
      box-shadow: 0 0 20px 5px;
    }
  }

  .fade-in-animation {
    animation: fadeIn 2s ease-in-out;
  }

  @keyframes fadeIn {
    0% {
      opacity: 0;
      transform: scale(0.7);
      filter: blur(10px);
    }

    50% {
      opacity: 0.5;
      filter: blur(5px);
    }

    100% {
      opacity: 1;
      transform: scale(1);
      filter: blur(0);
    }
  }

  .rarity-text {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 5px 10px;
    border-radius: 10px;
    color: white;
    font-weight: bold;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
  }

  .frog-container {
    position: relative;
    margin-top: 1rem;
  }

  .loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 24px;
    color: white;
    background: rgba(0, 0, 0, 0.7);
    padding: 10px 20px;
    border-radius: 10px;
    display: none;
  }

  .collection-container {
    margin-top: 30px;
    width: 90%;
    max-width: 800px;
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 15px;
    backdrop-filter: blur(5px);
    display: none;
  }

  .collection-title {
    color: white;
    text-align: center;
    margin-bottom: 15px;
    font-size: 1.2rem;
  }

  .collection-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 15px;
    justify-items: center;
  }

  .collection-item {
    position: relative;
    width: 100px;
    height: 100px;
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s ease;
  }

  .collection-item:hover {
    transform: scale(1.1);
  }

  .collection-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .collection-item .rarity-indicator {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 5px;
  }

  .collection-stats {
    display: flex;
    justify-content: space-around;
    margin-top: 15px;
    color: white;
    font-size: 0.9rem;
  }

  .toggle-collection {
    margin-top: 15px;
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid white;
    color: white;
    padding: 8px 15px;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .toggle-collection:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  .frog-detail-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    background-color: white;
    padding: 20px;
    border-radius: 15px;
    max-width: 80%;
    max-height: 80%;
    overflow: auto;
    position: relative;
  }

  .modal-close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 24px;
    cursor: pointer;
    color: #333;
  }

  .modal-image {
    max-width: 100%;
    max-height: 300px;
    border-radius: 10px;
    display: block;
    margin: 0 auto;
  }

  .modal-info {
    margin-top: 15px;
    text-align: center;
  }

  .pack-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    background-color: rgba(0, 0, 0, 0.7);
    perspective: 1000px;
    display: none;
    cursor: pointer;
  }

  .pack {
    width: 300px;
    height: 400px;
    position: relative;
    transform-style: preserve-3d;
    animation: packShake 1s ease-in-out;
  }

  .pack-front,
  .pack-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }

  .pack-front {
    background: linear-gradient(135deg, #16d0ca, #0ef056);
    z-index: 2;
    overflow: hidden;
  }

  .pack-back {
    background: white;
    z-index: 1;
  }

  .pack-front::before {
    content: '';
    position: absolute;
    width: 90%;
    height: 90%;
    border: 3px dashed rgba(255, 255, 255, 0.5);
    border-radius: 10px;
  }

  .pack-logo {
    width: 80%;
    max-height: 80%;
    object-fit: contain;
    z-index: 3;
  }

  .pack-text {
    position: absolute;
    bottom: 30px;
    color: white;
    font-weight: bold;
    font-size: 24px;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    text-align: center;
    z-index: 3;
  }

  .pack-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(90deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.4) 50%,
        rgba(255, 255, 255, 0) 100%);
    animation: shine 1.5s infinite;
    z-index: 2;
  }

  .pack-card {
    position: absolute;
    width: 80%;
    height: 80%;
    background: white;
    border-radius: 10px;
    transform: scale(0);
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    overflow: hidden;
  }

  .pack-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .pack-card-rarity {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 5px 10px;
    border-radius: 10px;
    color: white;
    font-weight: bold;
    font-size: 14px;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
  }

  .tear-effect {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 4;
    pointer-events: none;
  }

  .tear-left,
  .tear-right {
    position: absolute;
    width: 50%;
    height: 100%;
    background: linear-gradient(135deg, #16d0ca, #0ef056);
    overflow: hidden;
  }

  .tear-left {
    left: 0;
    border-radius: 15px 0 0 15px;
    transform-origin: right center;
  }

  .tear-right {
    right: 0;
    border-radius: 0 15px 15px 0;
    transform-origin: left center;
  }

  .tear-content-left,
  .tear-content-right {
    position: absolute;
    width: 200%;
    height: 100%;
    background: linear-gradient(135deg, #16d0ca, #0ef056);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .tear-content-left {
    left: 0;
  }

  .tear-content-right {
    right: 0;
  }

  .tear-content-left::before,
  .tear-content-right::before {
    content: '';
    position: absolute;
    width: 90%;
    height: 90%;
    border: 3px dashed rgba(255, 255, 255, 0.5);
    border-radius: 10px;
  }

  .tear-open-left {
    animation: tearLeft 0.8s forwards;
  }

  .tear-open-right {
    animation: tearRight 0.8s forwards;
  }

  @keyframes tearLeft {
    0% {
      transform: translateX(0) rotateY(0);
    }

    100% {
      transform: translateX(-100%) rotateY(30deg);
    }
  }

  @keyframes tearRight {
    0% {
      transform: translateX(0) rotateY(0);
    }

    100% {
      transform: translateX(100%) rotateY(-30deg);
    }
  }

  .card-reveal {
    animation: revealCard 0.7s 0.8s forwards;
  }

  .confetti {
    position: absolute;
    width: 10px;
    height: 10px;
    background-color: #f00;
    opacity: 0;
    z-index: 1001;
  }

  @keyframes confettiFall {
    0% {
      transform: translateY(-100px) rotate(0deg);
      opacity: 1;
    }

    100% {
      transform: translateY(1000px) rotate(360deg);
      opacity: 0;
    }
  }

  .multi-pack-options {
    display: flex;
    gap: 10px;
    margin-top: 15px;
  }

  .multi-pack-btn {
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid white;
    color: white;
    padding: 8px 15px;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease;
    font-weight: bold;
  }

  .multi-pack-btn:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  .pack-counter {
    position: absolute;
    top: 20px;
    right: 20px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 15px;
    border-radius: 10px;
    font-weight: bold;
    z-index: 1002;
    display: none;
  }

  .pack-instructions {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 15px;
    border-radius: 10px;
    font-weight: bold;
    z-index: 1002;
    text-align: center;
  }

  @keyframes packShake {

    0%,
    100% {
      transform: translateY(0) rotateZ(0);
    }

    25% {
      transform: translateY(-10px) rotateZ(-5deg);
    }

    50% {
      transform: translateY(0) rotateZ(0);
    }

    75% {
      transform: translateY(-5px) rotateZ(5deg);
    }
  }

  @keyframes revealCard {
    0% {
      transform: scale(0);
      opacity: 0;
    }

    50% {
      transform: scale(1.2);
      opacity: 1;
    }

    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  @keyframes shine {
    0% {
      left: -100%;
    }

    100% {
      left: 100%;
    }
  }

  .multi-pack-grid {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    display: none;
    padding: 20px;
    overflow-y: auto;
  }

  .grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
    max-width: 1200px;
    margin: 0 auto;
  }

  .mini-pack {
    width: 100%;
    height: 300px;
    position: relative;
    transform-style: preserve-3d;
    margin: 0 auto;
    cursor: pointer;
    perspective: 1000px;
  }

  .mini-pack-front {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    background: linear-gradient(135deg, #16d0ca, #0ef056);
    backface-visibility: hidden;
    transition: transform 0.8s;
  }

  .mini-pack-back {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 15px;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
    background: white;
    backface-visibility: hidden;
    transform: rotateY(180deg);
    transition: transform 0.8s;
  }

  .mini-pack-card {
    width: 80%;
    height: 80%;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
  }

  .mini-pack-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .mini-pack-rarity {
    position: absolute;
    top: 10px;
    right: 10px;
    padding: 5px 10px;
    border-radius: 10px;
    color: white;
    font-weight: bold;
    font-size: 14px;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
  }

  .mini-pack-logo {
    width: 60%;
    max-height: 60%;
    object-fit: contain;
  }

  .mini-pack-text {
    position: absolute;
    bottom: 20px;
    color: white;
    font-weight: bold;
    font-size: 16px;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    text-align: center;
  }

  .mini-pack-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 50%;
    height: 100%;
    background: linear-gradient(90deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.4) 50%,
        rgba(255, 255, 255, 0) 100%);
    animation: shine 1.5s infinite;
  }

  .mini-pack-flipped .mini-pack-front {
    transform: rotateY(180deg);
  }

  .mini-pack-flipped .mini-pack-back {
    transform: rotateY(0deg);
  }

  .grid-controls {
    display: flex;
    justify-content: center;
    margin: 20px 0;
  }

  .grid-controls button {
    background: rgba(255, 255, 255, 0.3);
    border: 1px solid white;
    color: white;
    padding: 10px 20px;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s ease;
    font-weight: bold;
    margin: 0 10px;
  }

  .grid-controls button:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  .initial-pack {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 5;
  }
</style>

<body>
  <div class="container">
    <img src="https://svg-files.pixelied.com/d75398af-665a-499e-ad17-11fea52c21aa/thumb-256px.png" alt=""
      style="width: 8rem; margin: 1rem; transition: 0.4s" />
    <h1 style="
          text-align: center;
          font-size: 1.3 rem;
          width: 20rem;
          margin: 0 auto;
        ">
      Gerador de sapos da helena
    </h1>
    <audio id="audio" src="https://od.lk/s/MjhfMzI5MDYxNjVf/frog-croaking-soundbible%20%28mp3cut.net%29.mp3"
      type="audio/mp3"></audio>
    <div class="frog-container">
      <img src="" alt="" class="animal" />
      <div class="rarity-text"></div>
      <div class="loading">Procurando sapo...</div>
    </div>
    <input type="button" id="gerarAnimal" value="Gerar sapo" />
    <div class="multi-pack-options">
      <button class="multi-pack-btn" data-count="3">Abrir 3 pacotes</button>
      <button class="multi-pack-btn" data-count="5">Abrir 5 pacotes</button>
      <button class="multi-pack-btn" data-count="10">Abrir 10 pacotes</button>
    </div>
    <p id="frogCount" style="color: white; margin-top: 10px;">Sapos encontrados: 0</p>
    <button class="toggle-collection">Ver Coleção de Sapos</button>

    <div class="collection-container">
      <h2 class="collection-title">Minha Coleção de Sapos</h2>
      <div class="collection-grid"></div>
      <div class="collection-stats">
        <span>Total: <span id="total-frogs">0</span></span>
        <span>Comuns: <span id="common-frogs">0</span></span>
        <span>Incomuns: <span id="uncommon-frogs">0</span></span>
        <span>Raros: <span id="rare-frogs">0</span></span>
        <span>Épicos: <span id="epic-frogs">0</span></span>
        <span>Lendários: <span id="legendary-frogs">0</span></span>
      </div>
    </div>
  </div>

  <div class="pack-container">
    <div class="pack-counter">Pacote 1 de 1</div>
    <div class="pack-instructions">Clique no pacote para abrir</div>
    <div class="pack">
      <div class="pack-front">
        <div class="pack-shine"></div>
        <img src="https://svg-files.pixelied.com/d75398af-665a-499e-ad17-11fea52c21aa/thumb-256px.png" alt="Logo"
          class="pack-logo">
        <div class="pack-text">Pacote de Sapos</div>
      </div>
      <div class="tear-effect">
        <div class="tear-left">
          <div class="tear-content-left">
            <img src="https://svg-files.pixelied.com/d75398af-665a-499e-ad17-11fea52c21aa/thumb-256px.png" alt="Logo"
              class="pack-logo">
          </div>
        </div>
        <div class="tear-right">
          <div class="tear-content-right">
            <img src="https://svg-files.pixelied.com/d75398af-665a-499e-ad17-11fea52c21aa/thumb-256px.png" alt="Logo"
              class="pack-logo">
          </div>
        </div>
      </div>
      <div class="pack-back">
        <div class="pack-card">
          <img src="" alt="Sapo" class="pack-card-img">
          <div class="pack-card-rarity"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="frog-detail-modal">
    <div class="modal-content">
      <span class="modal-close">&times;</span>
      <img src="" alt="Sapo" class="modal-image">
      <div class="modal-info">
        <h3 class="modal-title">Sapo</h3>
        <p class="modal-rarity">Raridade: <span></span></p>
        <p class="modal-date">Encontrado em: <span></span></p>
      </div>
    </div>
  </div>

  <audio id="pack-audio" src="https://assets.mixkit.co/sfx/preview/mixkit-opening-a-soda-can-2355.mp3"
    type="audio/mp3"></audio>
  <audio id="rare-audio" src="https://assets.mixkit.co/sfx/preview/mixkit-magical-coin-win-1936.mp3"
    type="audio/mp3"></audio>
  <audio id="tear-audio" src="https://assets.mixkit.co/sfx/preview/mixkit-paper-rip-1376.mp3" type="audio/mp3"></audio>

  <div class="multi-pack-grid">
    <div class="grid-controls">
      <button id="flip-all-btn">Revelar Todos</button>
      <button id="collect-all-btn">Coletar Todos</button>
    </div>
    <div class="grid-container">
    </div>
  </div>

  <script>
    const accessKey = "YOUR_UNSPLASH_ACCESS_KEY";
    const pixabayApiKey = "36988838-387af5e03afe457efbd43c534";

    const rarities = [
      { name: "Comum", chance: 60, class: "rarity-common", color: "#a0a0a0" },
      { name: "Incomum", chance: 25, class: "rarity-uncommon", color: "#4CAF50" },
      { name: "Raro", chance: 10, class: "rarity-rare", color: "#2196F3" },
      { name: "Épico", chance: 4, class: "rarity-epic", color: "#9C27B0" },
      { name: "Lendário", chance: 1, class: "rarity-legendary", color: "#FFD700" }
    ];

    let frogCount = 0;
    const frogImage = document.querySelector(".animal");
    const rarityText = document.querySelector(".rarity-text");
    const loadingElement = document.querySelector(".loading");
    const frogCountElement = document.getElementById("frogCount");
    const collectionContainer = document.querySelector(".collection-container");
    const collectionGrid = document.querySelector(".collection-grid");
    const toggleCollectionBtn = document.querySelector(".toggle-collection");
    const modal = document.querySelector(".frog-detail-modal");
    const modalClose = document.querySelector(".modal-close");
    const modalImage = document.querySelector(".modal-image");
    const modalTitle = document.querySelector(".modal-title");
    const modalRarity = document.querySelector(".modal-rarity span");
    const modalDate = document.querySelector(".modal-date span");

    const packContainer = document.querySelector(".pack-container");
    const pack = document.querySelector(".pack");
    const packCardImg = document.querySelector(".pack-card-img");
    const packCardRarity = document.querySelector(".pack-card-rarity");
    const packAudio = document.getElementById("pack-audio");
    const rareAudio = document.getElementById("rare-audio");
    const tearAudio = document.getElementById("tear-audio");
    const tearLeft = document.querySelector(".tear-left");
    const tearRight = document.querySelector(".tear-right");

    const packCounter = document.querySelector(".pack-counter");
    const packInstructions = document.querySelector(".pack-instructions");
    const multiPackButtons = document.querySelectorAll(".multi-pack-btn");

    let multiPackQueue = [];
    let currentPackIndex = 0;
    let totalPacks = 0;

    let frogCollection = loadCollection();

    updateCollectionStats();

    function playAudio() {
      var audio = document.getElementById("audio");
      audio.currentTime = 0;
      audio.play();
    }

    function playPackOpenSound() {
      packAudio.currentTime = 0;
      packAudio.play();
    }

    function playRareSound() {
      rareAudio.currentTime = 0;
      rareAudio.play();
    }

    function playTearSound() {
      tearAudio.currentTime = 0;
      tearAudio.play();
    }

    function getRarity() {
      const random = Math.random() * 100;
      let cumulativeChance = 0;

      for (const rarity of rarities) {
        cumulativeChance += rarity.chance;
        if (random <= cumulativeChance) {
          return rarity;
        }
      }

      return rarities[0];
    }

    function createConfetti(isRare) {
      const colors = isRare ?
        ['#FFD700', '#FFC107', '#FF9800', '#FF5722', '#F44336'] :
        ['#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107'];

      const container = document.querySelector('.pack-container');


      const oldConfetti = document.querySelectorAll('.confetti');
      oldConfetti.forEach(c => c.remove());


      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';

        const x = Math.random() * window.innerWidth;
        const delay = Math.random() * 3;
        const duration = 2 + Math.random() * 2;

        confetti.style.left = `${x}px`;
        confetti.style.top = '-10px';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.width = `${5 + Math.random() * 10}px`;
        confetti.style.height = `${5 + Math.random() * 10}px`;
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
        confetti.style.opacity = '0';

        confetti.style.animation = `confettiFall ${duration}s ${delay}s ease-in forwards`;

        container.appendChild(confetti);
      }
    }

    function saveCollection() {
      localStorage.setItem('frogCollection', JSON.stringify(frogCollection));
      updateCollectionStats();
    }

    function loadCollection() {
      const saved = localStorage.getItem('frogCollection');
      return saved ? JSON.parse(saved) : [];
    }

    function updateCollectionStats() {
      document.getElementById('total-frogs').textContent = frogCollection.length;

      const counts = {
        "Comum": 0,
        "Incomum": 0,
        "Raro": 0,
        "Épico": 0,
        "Lendário": 0
      };

      frogCollection.forEach(frog => {
        counts[frog.rarity]++;
      });

      document.getElementById('common-frogs').textContent = counts["Comum"];
      document.getElementById('uncommon-frogs').textContent = counts["Incomum"];
      document.getElementById('rare-frogs').textContent = counts["Raro"];
      document.getElementById('epic-frogs').textContent = counts["Épico"];
      document.getElementById('legendary-frogs').textContent = counts["Lendário"];

      renderCollection();
    }

    function renderCollection() {
      collectionGrid.innerHTML = '';

      frogCollection.forEach((frog, index) => {
        const item = document.createElement('div');
        item.className = 'collection-item';
        item.dataset.index = index;

        const img = document.createElement('img');
        img.src = frog.imageUrl;
        img.alt = `Sapo ${frog.rarity}`;

        const rarityIndicator = document.createElement('div');
        rarityIndicator.className = 'rarity-indicator';
        rarityIndicator.style.backgroundColor = frog.color;

        item.appendChild(img);
        item.appendChild(rarityIndicator);
        collectionGrid.appendChild(item);

        item.addEventListener('click', () => showFrogDetails(frog));
      });
    }

    function showFrogDetails(frog) {
      modalImage.src = frog.imageUrl;
      modalTitle.textContent = `Sapo ${frog.rarity}`;
      modalRarity.textContent = frog.rarity;
      modalRarity.style.color = frog.color;
      modalDate.textContent = new Date(frog.date).toLocaleString();

      modal.style.display = 'flex';
    }

    function showPackAnimation(imageUrl, rarity) {
      packCardImg.src = imageUrl;
      packCardRarity.textContent = rarity.name;
      packCardRarity.style.backgroundColor = rarity.color;

      tearLeft.classList.remove("tear-open-left");
      tearRight.classList.remove("tear-open-right");

      const packFront = document.querySelector(".pack-front");
      packFront.style.display = "flex";

      const packCard = document.querySelector('.pack-card');
      packCard.classList.remove('card-reveal');


      if (multiPackQueue.length > 0) {
        currentPackIndex++;
        packCounter.textContent = `Pacote ${currentPackIndex} de ${totalPacks}`;
        packCounter.style.display = "block";
        packInstructions.style.display = "block";
      } else {
        packCounter.style.display = "none";
        packInstructions.style.display = "block";
      }

      packContainer.style.cursor = "pointer";
      packContainer.style.display = 'flex';

      packContainer.onclick = function () {
        startPackOpenAnimation(imageUrl, rarity);
      };
    }

    function startPackOpenAnimation(imageUrl, rarity) {
      packContainer.onclick = null;
      packInstructions.style.display = "none";

      playTearSound();

      const packFront = document.querySelector(".pack-front");
      packFront.style.display = "none";
      tearLeft.classList.add("tear-open-left");
      tearRight.classList.add("tear-open-right");

      setTimeout(() => {
        const packCard = document.querySelector('.pack-card');
        packCard.classList.add('card-reveal');

        const isRare = rarity.name === "Raro" || rarity.name === "Épico" || rarity.name === "Lendário";
        if (isRare) {
          setTimeout(() => {
            playRareSound();
            createConfetti(isRare);
          }, 500);
        }

        setTimeout(() => {
          packContainer.style.display = 'none';
          displayFrogAfterPack(imageUrl, rarity);


          if (multiPackQueue.length > 0) {
            const nextPack = multiPackQueue.shift();
            setTimeout(() => {
              showPackAnimation(nextPack.imageUrl, nextPack.rarity);
            }, 500);
          } else {

            currentPackIndex = 0;
            totalPacks = 0;
          }
        }, 1500);
      }, 800);
    }

    function displayFrogAfterPack(imageUrl, rarity) {
      frogImage.src = imageUrl;
      frogImage.style.opacity = "1";

      rarities.forEach(r => frogImage.classList.remove(r.class));


      const fixedRarity = getFixedRarityFromId(extractImageId(imageUrl));

      frogImage.classList.add(fixedRarity.class);

      rarityText.textContent = fixedRarity.name;
      rarityText.style.backgroundColor = fixedRarity.color;
      rarityText.style.display = "block";

      playAudio();


      addFrogToCollection(imageUrl, fixedRarity);
    }

    function addFrogToCollection(imageUrl, rarity) {

      const imageId = extractImageId(imageUrl);


      const existingFrogIndex = frogCollection.findIndex(frog =>
        extractImageId(frog.imageUrl) === imageId
      );


      if (existingFrogIndex >= 0) {
        return false;
      }


      frogCollection.push({
        imageUrl: imageUrl,
        rarity: rarity.name,
        class: rarity.class,
        color: rarity.color,
        date: new Date().toISOString()
      });

      saveCollection();
      return true;
    }

    async function gerarAnimal(count = 1) {
      const button = document.getElementById("gerarAnimal");
      button.disabled = true;
      button.value = "Procurando...";


      multiPackButtons.forEach(btn => btn.disabled = true);

      loadingElement.style.display = "block";
      frogImage.style.opacity = "0.3";

      try {

        multiPackQueue = [];
        currentPackIndex = 0;
        totalPacks = count;
        gridPacks = [];


        for (let i = 0; i < count; i++) {
          const rarity = getRarity();
          let imageUrl = await getFrogFromUnsplash();

          if (!imageUrl) {
            imageUrl = await getFrogFromPixabay();
          }

          if (imageUrl) {
            frogCount++;


            if (count === 1) {
              frogCountElement.textContent = `Sapos encontrados: ${frogCount}`;
              loadingElement.style.display = "none";
              showPackAnimation(imageUrl, rarity);
            } else {

              gridPacks.push({ imageUrl, rarity });
            }
          } else {
            console.error("Não foi possível encontrar imagens de sapos");
            loadingElement.textContent = "Erro ao buscar sapo :(";
            setTimeout(() => {
              loadingElement.style.display = "none";
              frogImage.style.opacity = "1";
            }, 2000);
            break;
          }
        }


        if (count > 1 && gridPacks.length > 0) {
          loadingElement.style.display = "none";
          frogImage.style.opacity = "1";
          showMultiPackGrid();
        }


        frogCountElement.textContent = `Sapos encontrados: ${frogCount}`;

      } catch (error) {
        console.error("Erro:", error);
        loadingElement.textContent = "Erro ao buscar sapo :(";
        setTimeout(() => {
          loadingElement.style.display = "none";
          frogImage.style.opacity = "1";
        }, 2000);
      }

      button.disabled = false;
      button.value = "Gerar sapo";


      multiPackButtons.forEach(btn => btn.disabled = false);
    }

    async function getFrogFromUnsplash() {
      try {
        const searchTerms = ["frog", "tree frog", "green frog", "poison dart frog", "bullfrog"];
        const randomTerm = searchTerms[Math.floor(Math.random() * searchTerms.length)];

        const response = await fetch(`https://api.unsplash.com/photos/random?query=${randomTerm}&count=1`, {
          headers: {
            Authorization: `Client-ID ${accessKey}`
          }
        });

        if (response.ok) {
          const data = await response.json();
          if (data && data.length > 0) {
            return data[0].urls.regular;
          }
        }
        return null;
      } catch (error) {
        console.error("Erro na API Unsplash:", error);
        return null;
      }
    }

    async function getFrogFromPixabay() {
      try {
        const searchTerms = ["frog", "tree frog", "green frog", "toad"];
        const randomTerm = searchTerms[Math.floor(Math.random() * searchTerms.length)];

        const url = `https://pixabay.com/api/?key=${pixabayApiKey}&q=${encodeURIComponent(randomTerm)}&image_type=photo`;
        const response = await fetch(url);
        const data = await response.json();

        if (data.hits && data.hits.length > 0) {
          const randomIndex = Math.floor(Math.random() * data.hits.length);
          return data.hits[randomIndex].webformatURL;
        }
        return null;
      } catch (error) {
        console.error("Erro na API Pixabay:", error);
        return null;
      }
    }

    toggleCollectionBtn.addEventListener('click', () => {
      if (collectionContainer.style.display === 'none' || !collectionContainer.style.display) {
        collectionContainer.style.display = 'block';
        toggleCollectionBtn.textContent = 'Esconder Coleção';
      } else {
        collectionContainer.style.display = 'none';
        toggleCollectionBtn.textContent = 'Ver Coleção de Sapos';
      }
    });

    modalClose.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    });


    multiPackButtons.forEach(button => {
      button.addEventListener('click', () => {
        const count = parseInt(button.dataset.count);
        gerarAnimal(count);
      });
    });

    document.getElementById("gerarAnimal").addEventListener("click", () => gerarAnimal(1));


    gerarAnimal(1);

    const multiPackGrid = document.querySelector(".multi-pack-grid");
    const gridContainer = document.querySelector(".grid-container");
    const flipAllBtn = document.getElementById("flip-all-btn");
    const collectAllBtn = document.getElementById("collect-all-btn");

    let gridPacks = [];

    function showMultiPackGrid() {

      gridContainer.innerHTML = '';


      gridPacks.forEach((pack, index) => {
        const miniPack = document.createElement('div');
        miniPack.className = 'mini-pack';
        miniPack.dataset.index = index;

        const front = document.createElement('div');
        front.className = 'mini-pack-front';

        const shine = document.createElement('div');
        shine.className = 'mini-pack-shine';

        const logo = document.createElement('img');
        logo.className = 'mini-pack-logo';
        logo.src = 'https://svg-files.pixelied.com/d75398af-665a-499e-ad17-11fea52c21aa/thumb-256px.png';
        logo.alt = 'Logo';

        const text = document.createElement('div');
        text.className = 'mini-pack-text';
        text.textContent = 'Pacote de Sapos';

        front.appendChild(shine);
        front.appendChild(logo);
        front.appendChild(text);

        const back = document.createElement('div');
        back.className = 'mini-pack-back';

        const card = document.createElement('div');
        card.className = 'mini-pack-card';

        const img = document.createElement('img');
        img.src = pack.imageUrl;
        img.alt = 'Sapo';


        const fixedRarity = getFixedRarityFromId(extractImageId(pack.imageUrl));
        pack.rarity = fixedRarity;

        const rarityBadge = document.createElement('div');
        rarityBadge.className = 'mini-pack-rarity';
        rarityBadge.textContent = fixedRarity.name;
        rarityBadge.style.backgroundColor = fixedRarity.color;

        card.appendChild(img);
        card.appendChild(rarityBadge);
        back.appendChild(card);

        miniPack.appendChild(front);
        miniPack.appendChild(back);


        miniPack.addEventListener('click', () => {
          if (!miniPack.classList.contains('mini-pack-flipped')) {
            miniPack.classList.add('mini-pack-flipped');
            playTearSound();


            const isRare = pack.rarity.name === "Raro" || pack.rarity.name === "Épico" || pack.rarity.name === "Lendário";
            if (isRare) {
              setTimeout(() => {
                playRareSound();
              }, 500);
            }


            addFrogToCollection(pack.imageUrl, pack.rarity);
          }
        });

        gridContainer.appendChild(miniPack);
      });


      multiPackGrid.style.display = 'block';
    }


    function flipAllPacks() {
      const miniPacks = document.querySelectorAll('.mini-pack:not(.mini-pack-flipped)');

      if (miniPacks.length > 0) {
        playTearSound();

        miniPacks.forEach((pack, index) => {
          setTimeout(() => {
            pack.classList.add('mini-pack-flipped');


            const packIndex = parseInt(pack.dataset.index);
            const packData = gridPacks[packIndex];


            const isRare = packData.rarity.name === "Raro" || packData.rarity.name === "Épico" || packData.rarity.name === "Lendário";
            if (isRare && index === 0) {
              setTimeout(() => {
                playRareSound();
              }, 500);
            }


            if (!pack.classList.contains('collected')) {
              pack.classList.add('collected');

              addFrogToCollection(packData.imageUrl, packData.rarity);
            }
          }, index * 200);
        });
      }
    }


    function collectAllPacks() {

      const miniPacks = document.querySelectorAll('.mini-pack:not(.collected)');
      miniPacks.forEach(pack => {
        const packIndex = parseInt(pack.dataset.index);
        const packData = gridPacks[packIndex];

        addFrogToCollection(packData.imageUrl, packData.rarity);
        pack.classList.add('collected');
      });


      multiPackGrid.style.display = 'none';


      if (gridPacks.length > 0) {
        const lastPack = gridPacks[gridPacks.length - 1];
        displayFrogAfterPack(lastPack.imageUrl, lastPack.rarity);
      }
    }


    flipAllBtn.addEventListener('click', flipAllPacks);
    collectAllBtn.addEventListener('click', collectAllPacks);




    function extractImageId(url) {
      if (url.includes('unsplash.com')) {
        const match = url.match(/\/photos\/([a-zA-Z0-9_-]+)/);
        if (match && match[1]) return match[1];

        const photoIdMatch = url.match(/photo-([a-zA-Z0-9_-]+)/);
        if (photoIdMatch && photoIdMatch[1]) return photoIdMatch[1];
      }

      if (url.includes('pixabay.com')) {
        const match = url.match(/\/([0-9]+)_/);
        if (match && match[1]) return match[1];
      }

      return hashString(url);
    }


    function hashString(str) {
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        const char = str.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
      }
      return Math.abs(hash).toString();
    }


    function getFixedRarityFromId(id) {

      const numericValue = parseInt(id.replace(/[^0-9]/g, '').slice(0, 8) || '0', 10);


      const randomValue = (numericValue % 100) + 1;

      let cumulativeChance = 0;
      for (const rarity of rarities) {
        cumulativeChance += rarity.chance;
        if (randomValue <= cumulativeChance) {
          return rarity;
        }
      }

      return rarities[0];
    }

    window.addEventListener('DOMContentLoaded', function () {
      setupInitialPackDisplay();
    });

    function setupInitialPackDisplay() {
      frogImage.style.display = "none";
      rarityText.style.display = "none";

      const initialPackContainer = document.createElement('div');
      initialPackContainer.className = 'initial-pack';
      initialPackContainer.innerHTML = `
        <div class="pack" style="animation: packShake 3s ease-in-out infinite;">
          <div class="pack-front">
            <div class="pack-shine"></div>
            <img src="https://svg-files.pixelied.com/d75398af-665a-499e-ad17-11fea52c21aa/thumb-256px.png" alt="Logo" class="pack-logo">
            <div class="pack-text">Clique no botão para abrir</div>
          </div>
        </div>
      `;

      document.querySelector('.frog-container').appendChild(initialPackContainer);
    }

    const originalGerarAnimal = gerarAnimal;
    gerarAnimal = function (count = 1) {
      const initialPack = document.querySelector('.initial-pack');
      if (initialPack) {
        initialPack.remove();
        frogImage.style.display = "block";
      }

      return originalGerarAnimal(count);
    };
  </script>
</body>